import{o as L,i as k,q as w,m as q,w as h,n as S,e as T,f as B,d as g,b as p,l as I}from"./firebaseConfig-DPj6AoB7.js";import"./index.esm-CXXrB3IR.js";import"./site-navbar-fTlpGsp8.js";let r=null,s=!1;document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("addEventBtn"),e=document.getElementById("eventList"),a=document.getElementById("EventCard");t.addEventListener("click",()=>{window.location.href="add-event.html"}),L(T,i=>{if(!i){e.innerHTML="<p>Please sign in to view your events</p>";return}const E=k(p,"tasks"),C=w(E,h("ownerId","==",i.uid),h("isCompleted","==",!1),q("dueDate","asc"));let d=[],f=!1;S(C,l=>{const n=l.docs.map(o=>({id:o.id,...o.data()}));s&&f?(r&&clearTimeout(r),r=setTimeout(()=>{d=n,c(d),r=null},1300)):(d=n,c(d),f=!0)});function c(l){if(e.innerHTML="",l.length===0){e.innerHTML='<p style="text-align:center;color:#6d6d6d;">No tasks found</p>';return}l.forEach(n=>{const o=a.content.cloneNode(!0);o.querySelector(".evt-title").textContent=n.title,o.querySelector(".evt-date").textContent=n.dueDate||"No due date",o.querySelector(".evt-desc").textContent=n.description||"",n.isCompleted&&(o.querySelector(".evt-title").classList.add("is-done"),o.querySelector(".complete-toggle").checked=!0),o.querySelector(".complete-toggle").dataset.id=n.id,o.querySelector(".edit-btn").dataset.edit=n.id,o.querySelector(".delete-btn").dataset.delete=n.id,e.appendChild(o)}),x()}const u=document.getElementById("searchInput"),m=document.getElementById("clearSearch");u.addEventListener("input",l=>{const n=l.target.value.trim().toLowerCase();m.style.display=n?"block":"none";const o=d.filter(v=>v.title?.toLowerCase().includes(n)||v.description?.toLowerCase().includes(n));c(o)}),m.addEventListener("click",()=>{u.value="",m.style.display="none",c(d),u.focus()})})});function x(){document.querySelectorAll(".complete-toggle").forEach(t=>{t.addEventListener("change",async()=>{const e=t.closest(".evt-card"),a=e.querySelector(".evt-title").textContent;try{s=!0,e.style.transform="translateX(400px)",e.style.opacity="0",e.style.marginBottom="-100px",await B(g(p,"tasks",t.dataset.id),{isCompleted:!0,completedAt:Date.now()}),y(`"${a}" completed!`),setTimeout(()=>{e.remove(),s=!1},1300)}catch(i){console.error("Error completing task:",i),t.checked=!1,e.style.transform="translateX(0)",e.style.opacity="1",e.style.marginBottom="14px",s=!1}})}),document.querySelectorAll(".edit-btn").forEach(t=>{t.addEventListener("click",()=>{window.location.href=`add-event.html?id=${t.dataset.edit}`})}),document.querySelectorAll(".delete-btn").forEach(t=>{t.addEventListener("click",async()=>{const e=t.closest(".evt-card"),a=e.querySelector(".evt-title").textContent;try{s=!0,e.style.opacity="0",e.style.marginBottom="-100px",await I(g(p,"tasks",t.dataset.delete)),y(`"${a}" deleted!`),setTimeout(()=>{s=!1},1300)}catch(i){console.error("Error deleting task:",i),y("Failed to delete task"),e.style.opacity="1",s=!1}})})}function y(t){let e=document.getElementById("notificationContainer");e||(e=document.createElement("div"),e.id="notificationContainer",document.body.appendChild(e));const a=document.createElement("div");a.className="notification",a.textContent=t,e.appendChild(a),setTimeout(()=>{a.classList.add("show")},50),setTimeout(()=>{a.classList.remove("show"),setTimeout(()=>{a.remove()},300)},1700)}
